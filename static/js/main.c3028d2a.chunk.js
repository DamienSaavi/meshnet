(this.webpackJsonpmeshnet=this.webpackJsonpmeshnet||[]).push([[0],{22:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n.n(i),s=n(7),c=n.n(s),r=(n(22),n(3)),a=n(2),u=n(13),l=n(4),d=n(17),f=n.n(d),b=n(0);function h(e){var t=e.node,n=e.className,i=e.onDrag,o=e.onClick,s=(t.id,t.pos),c=t.peers;return Object(b.jsx)(f.a,{defaultClassName:"absolute ".concat(n),position:s,onDrag:function(e,t){var n=t.x,o=t.y;return i({x:n,y:o})},onMouseDown:function(e){return o(e)},bounds:"parent",children:Object(b.jsxs)("div",{className:"node transition-color select-none font-mono text-white bg-green-600 rounded-full shadow-xl w-16 h-16 flex flex-col justify-center items-center hover:bg-green-500 overflow-visible whitespace-nowrap hover:animate-ping",children:[Object(b.jsx)("div",{className:"text-xs font-bold",children:s.x+" "+s.y}),Object(b.jsxs)("div",{className:"flex-col text-xs peers hidden absolute left-full ml-2 p-1 bg-gray-500 rounded shadow-xl",children:[Object(b.jsx)("p",{className:"place-self-center",children:0===Object.keys(c).length?"lonely...":"PEERS"}),Object(b.jsx)("hr",{className:"my-0.5"}),Object.keys(c).map((function(e){return Object(b.jsx)("p",{children:e},e)}))]}),Object(b.jsx)("div",{className:"absolute transition-all duration-400 ease-out node-range z-0 bg-transparent rounded-full border w-0 h-0 opacity-0"})]})})}function j(e){var t=e.to,n=e.from,o=e.offset,s=Object(i.useRef)();return Object(i.useEffect)((function(){console.log("bloop"),s.current.attributes.cx.value=t.x+o,s.current.attributes.cy.value=t.y+o}),[]),Object(b.jsx)("circle",{ref:s,r:"8",cx:n.x+o,cy:n.y+o,fill:"orange",className:"transition-all duration-500 ease-out"})}function g(e){var t=e.onClick,n=e.title;return Object(b.jsx)("div",{className:"rounded-lg border-2 border-gray-400",children:Object(b.jsx)("button",{title:n,className:"flex justify-center items-center font-bold text-white bg-blue-500 leading-none p-3 px-3 w-40 max-w-prose border-b-4  border-blue-800 rounded-md hover:bg-blue-400 active:border-b-2 -mt-0.5 active:mt-0",onClick:t,children:n})})}function O(e){var t=e.from,n=e.to,i=e.offset;return Object(b.jsx)("line",{x1:t.x+i,y1:t.y+i,x2:n.x+i,y2:n.y+i,className:"line"})}var p=n(11),x=n(12),m=n(32),v=function(){function e(t){Object(p.a)(this,e),this.id=Object(m.a)(),this.data=t.data||"Boop!",this.destination=t.destination,this.source=t.source,this.route=[],this.station=t.station,this.created=Date.now()}return Object(x.a)(e,[{key:"pos",get:function(){return this.station.pos||null}},{key:"x",get:function(){return this.station.pos.x}},{key:"y",get:function(){return this.station.pos.y}}]),e}(),y=function(){function e(t){var n=this;Object(p.a)(this,e),this.updatePos=function(e){var t=e.x,i=e.y;n.pos={x:t,y:i}},this.addPeer=function(e){n.peers[e.id]||(n.peers=Object(a.a)(Object(a.a)({},n.peers),{},Object(r.a)({},e.id,e)))},this.removePeer=function(e){n.peers[e.id]&&delete n.peers[e.id]},this.sendData=function(e,t){if(t||(t=Object.keys(n.peers)[0]),t){var i=new v({data:e,destination:t,source:n.id,station:n});n.storeOutgoing(i)}},this.forwardPacket=function(e){n.peers[e.destination]?(e.route.push(n.id),n.peers[e.destination].storeIncoming(e),n.animatePacket(n.pos,n.peers[e.destination].pos,e.id)):n.outgoing.push(e)},this.openPacket=function(e){},this.storeOutgoing=function(e){n.outgoing.push(e),setTimeout((function(){n.handleOutgoing()}),1e3)},this.storeIncoming=function(e){e.station=n,n.incoming.push(e),setTimeout((function(){n.handleIncoming()}),1e3)},this.handleIncoming=function(){var e=n.incoming.shift();e&&(e.destination===n.id?n.openPacket(e):n.storeOutgoing(e))},this.handleOutgoing=function(){var e=n.outgoing.shift();e&&n.forwardPacket(e)},this.id=Object(m.a)(),this.pos={x:0,y:0},this.peers={},this.outgoing=[],this.incoming=[],this.animatePacket=t.animatePacket}return Object(x.a)(e,[{key:"x",get:function(){return this.pos.x}},{key:"y",get:function(){return this.pos.y}}]),e}();var w=function(){var e=Object(i.useState)({}),t=Object(l.a)(e,2),n=t[0],o=t[1],s=Object(i.useState)({}),c=Object(l.a)(s,2),d=c[0],f=c[1],p=Object(i.useState)([]),x=Object(l.a)(p,2),m=x[0],v=x[1],w=Object(i.useState)(null),k=Object(l.a)(w,2),N=(k[0],k[1],Object(i.useRef)());function P(e,t,n){m.push({from:e,to:t,id:n}),v(Object(u.a)(m)),console.log(e.x,t.x),setTimeout((function(){m.shift(),v(Object(u.a)(m))}),500)}Object(i.useEffect)((function(){for(var e={},t=0,i=Object.values(n);t<i.length;t++)for(var o=i[t],s=0,c=Object.values(o.peers);s<c.length;s++){var r=c[s],a=[o.id,r.id].sort().join("+");e[a]||(e[a]=[o.pos,r.pos])}f(e)}),[n]);var C=function(e,t){switch(t.button){case 0:e.sendData();break;case 1:!function(e){for(var t=Object(a.a)({},n),i=0,s=Object.values(t[e.id].peers);i<s.length;i++)delete s[i].peers[e.id];clearInterval(t[e.id].packetHandler),delete t[e.id],o(t)}(e)}};return Object(b.jsxs)("div",{className:"h-screen w-full flex flex-col overflow-hidden",children:[Object(b.jsx)("div",{className:"w-full relative z-50 bg-gray-800 border-b-2 border-gray-500 mx-auto flex justify-center items-center py-4",children:Object(b.jsx)(g,{title:"Add Node",onClick:function(){var e=new y({animatePacket:P});o(Object(a.a)(Object(r.a)({},e.id,e),n))}})}),Object(b.jsxs)("div",{className:"relative bg-gray-700 flex-grow",children:[Object(b.jsx)("div",{className:"absolute z-20 w-full h-full",children:Object.keys(n).length>0?Object.values(n).map((function(e){return Object(b.jsx)(h,{node:e,onClick:function(t){return C(e,t)},onDrag:function(t){return function(e,t){n[e.id].updatePos(t),Object.values(n).forEach((function(t){e.id!==t.id&&(Math.hypot(e.x-t.x,e.y-t.y)<=300?(n[e.id].addPeer(t),n[t.id].addPeer(e)):(n[e.id].removePeer(t),n[t.id].removePeer(e)))})),o(Object(a.a)({},n))}(e,t)}},e.id)})):null}),Object(b.jsxs)("svg",{ref:N,width:"100%",height:"100%",className:"absolute z-0",xmlns:"http://www.w3.org/2000/svg",children:[Object.keys(d).map((function(e){var t=Object(l.a)(d[e],2),n=t[0],i=t[1];return Object(b.jsx)(O,{from:n,to:i,offset:32},e)})),m.map((function(e){return Object(b.jsx)(j,{from:e.from,to:e.to,offset:32},e.id)}))]}),Object(b.jsx)("div",{className:"relative z-10 w-full h-full"})]})]})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,33)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),i(e),o(e),s(e),c(e)}))};c.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(w,{})}),document.getElementById("root")),k()}},[[30,1,2]]]);
//# sourceMappingURL=main.c3028d2a.chunk.js.map