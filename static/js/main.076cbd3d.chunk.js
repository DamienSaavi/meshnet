(this.webpackJsonpmeshnet=this.webpackJsonpmeshnet||[]).push([[0],{19:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),r=n(6),a=n.n(r),c=(n(19),n(3)),o=n(2),l=n(4),d=n(14),u=n.n(d),b=n(0);function f(e){var t=e.node,n=e.className,s=e.onDrag,i=e.onClick,r=(t.id,t.pos),a=t.peers;return Object(b.jsx)(u.a,{defaultClassName:"absolute ".concat(n),position:r,onDrag:function(e,t){var n=t.x,i=t.y;return s({x:n,y:i})},onMouseDown:function(e){return i(e)},bounds:"parent",children:Object(b.jsxs)("div",{className:"node transition-color select-none font-mono text-white bg-green-600 rounded-full shadow-xl w-16 h-16 flex flex-col justify-center items-center hover:bg-green-500 overflow-visible whitespace-nowrap hover:animate-ping",children:[Object(b.jsx)("div",{className:"text-xs font-bold",children:r.x+" "+r.y}),Object(b.jsxs)("div",{className:"flex-col text-xs peers hidden absolute left-full ml-2 p-1 bg-gray-500 rounded shadow-xl",children:[Object(b.jsx)("p",{className:"place-self-center",children:0===Object.keys(a).length?"lonely...":"PEERS"}),Object(b.jsx)("hr",{className:"my-0.5"}),Object.keys(a).map((function(e){return Object(b.jsx)("p",{children:e},e)}))]}),Object(b.jsx)("div",{className:"absolute transition-all duration-400 ease-out node-range z-0 bg-transparent rounded-full border w-0 h-0 opacity-0"})]})})}function h(e){var t=e.onClick,n=e.title;return Object(b.jsx)("div",{className:"rounded-lg border-2 border-gray-400",children:Object(b.jsx)("button",{title:n,className:"flex justify-center items-center font-bold text-white bg-blue-500 leading-none p-3 px-3 w-40 max-w-prose border-b-4  border-blue-800 rounded-md hover:bg-blue-400 active:border-b-2 -mt-0.5 active:mt-0",onClick:t,children:n})})}function j(e){var t=e.from,n=e.to,s=e.offset;return Object(b.jsx)("line",{x1:t.x+s,y1:t.y+s,x2:n.x+s,y2:n.y+s,className:"line"})}var p=n(7),x=n(8),v=n(29),O=function(){function e(t){Object(p.a)(this,e),this.data=t.data||"Hi :)",this.destination=t.destination,this.route=[],this.station=null}return Object(x.a)(e,[{key:"pos",get:function(){return this.station.pos}},{key:"x",get:function(){return this.station.pos.x}},{key:"y",get:function(){return this.station.pos.y}}]),e}(),g=function(){function e(){var t=this;Object(p.a)(this,e),this.updatePos=function(e){var n=e.x,s=e.y;t.pos={x:n,y:s}},this.addPeer=function(e){t.peers[e.id]||(t.peers=Object(o.a)(Object(o.a)({},t.peers),{},Object(c.a)({},e.id,e)))},this.removePeer=function(e){t.peers[e.id]&&delete t.peers[e.id]},this.sendData=function(e,n){var s=Object.keys(t.peers)[0];if(s){var i=new O({data:e,destination:s,sourceID:t.id});t.recievePacket(i)}},this.relayPacket=function(e){t.peers[e.destination]?(e.route.push(t.id),t.peers[e.destination].recievePacket(e)):t.packets.push(e)},this.recievePacket=function(e){e.station=t,t.packets.push(e)},this.openPacket=function(e){console.log("PACKET RECIEVED BY "+t.id),console.log("PACKET DATA: "+e.data)},this.handlePacket=function(){var e=t.packets.pop();e&&(e.destination===t.id?t.openPacket(e):t.relayPacket(e))},this.id=Object(v.a)(),this.pos={x:0,y:0},this.peers={},this.packets=[],this.packetHandler=setInterval((function(){t.handlePacket()}),3e3)}return Object(x.a)(e,[{key:"x",get:function(){return this.pos.x}},{key:"y",get:function(){return this.pos.y}}]),e}();var y=function(){var e=Object(s.useState)({}),t=Object(l.a)(e,2),n=t[0],i=t[1],r=Object(s.useState)({}),a=Object(l.a)(r,2),d=a[0],u=a[1],p=Object(s.useState)(null),x=Object(l.a)(p,2);function v(){var e=new g;i(Object(o.a)(Object(c.a)({},e.id,e),n))}x[0],x[1],Object(s.useEffect)((function(){v()}),[]),Object(s.useEffect)((function(){for(var e={},t=0,s=Object.values(n);t<s.length;t++)for(var i=s[t],r=0,a=Object.values(i.peers);r<a.length;r++){var c=a[r],o=[i.id,c.id].sort().join("+");e[o]||(e[o]=[i.pos,c.pos])}u(e)}),[n]);var O=function(e,t){switch(t.button){case 0:e.sendData();break;case 1:!function(e){for(var t=Object(o.a)({},n),s=0,r=Object.values(t[e.id].peers);s<r.length;s++)delete r[s].peers[e.id];clearInterval(t[e.id].packetHandler),delete t[e.id],i(t)}(e)}};return Object(b.jsxs)("div",{className:"h-screen w-full flex flex-col overflow-hidden",children:[Object(b.jsx)("div",{className:"w-full relative z-50 bg-gray-800 border-b-2 border-gray-500 mx-auto flex justify-center items-center py-4",children:Object(b.jsx)(h,{title:"Add Node",onClick:v})}),Object(b.jsxs)("div",{className:"relative bg-gray-700 flex-grow",children:[Object.keys(n).length>0?Object.values(n).map((function(e){return Object(b.jsx)(f,{node:e,onClick:function(t){return O(e,t)},onDrag:function(t){return function(e,t){var s=Object(o.a)({},n);s[e.id].updatePos(t),Object.values(s).forEach((function(t){e.id!==t.id&&(Math.hypot(e.x-t.x,e.y-t.y)<=300?(s[e.id].addPeer(t),s[t.id].addPeer(e)):(s[e.id].removePeer(t),s[t.id].removePeer(e)))})),i(s)}(e,t)}},e.id)})):null,Object(b.jsx)("svg",{width:"100%",height:"100%",children:Object.keys(d).map((function(e){var t=Object(l.a)(d[e],2),n=t[0],s=t[1];return Object(b.jsx)(j,{from:n,to:s,offset:32},e)}))})]})]})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,s=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),s(e),i(e),r(e),a(e)}))};a.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(y,{})}),document.getElementById("root")),m()}},[[27,1,2]]]);
//# sourceMappingURL=main.076cbd3d.chunk.js.map